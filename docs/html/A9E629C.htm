<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>UserAccountControl.GetProcessIntegrityLevel Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="GetProcessIntegrityLevel method" /><meta name="System.Keywords" content="UserAccountControl.GetProcessIntegrityLevel method" /><meta name="Microsoft.Help.F1" content="TomsToolbox.Desktop.UserAccountControl.GetProcessIntegrityLevel" /><meta name="Microsoft.Help.Id" content="M:TomsToolbox.Desktop.UserAccountControl.GetProcessIntegrityLevel" /><meta name="Description" content="The function gets the integrity level of the current process. Integrity level is only available on Windows Vista and newer operating systems, thus GetProcessIntegrityLevel throws a C++ exception if it is called on systems prior to Windows Vista." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="TomsToolbox.Desktop" /><meta name="file" content="A9E629C" /><meta name="guid" content="A9E629C" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.5.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Tom's Toolbox<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/70e0e697-583b-46c1-94a3-a992d398d79a.htm" title="Tom's Toolbox" tocid="roottoc">Tom's Toolbox</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/85360FD0.htm" title="TomsToolbox.Desktop" tocid="85360FD0">TomsToolbox.Desktop</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/A126C345.htm" title="UserAccountControl Class" tocid="A126C345">UserAccountControl Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/D3EAC9B7.htm" title="UserAccountControl Methods" tocid="D3EAC9B7">UserAccountControl Methods</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/A9E629C.htm" title="GetProcessIntegrityLevel Method " tocid="A9E629C">GetProcessIntegrityLevel Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/1882189C.htm" title="IsCurrentUserInAdminGroup Method " tocid="1882189C">IsCurrentUserInAdminGroup Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/FCB72C0B.htm" title="IsCurrentUserInGroup Method " tocid="FCB72C0B">IsCurrentUserInGroup Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/A819D97B.htm" title="IsProcessElevated Method " tocid="A819D97B">IsProcessElevated Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/859CD32E.htm" title="IsRunAsAdmin Method " tocid="859CD32E">IsRunAsAdmin Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/8256C035.htm" title="IsUserInAdminGroup Method " tocid="8256C035">IsUserInAdminGroup Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/538AA02B.htm" title="IsUserInGroup Method " tocid="538AA02B">IsUserInGroup Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/A1851810.htm" title="LogOnInteractiveUser Method " tocid="A1851810">LogOnInteractiveUser Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/F8286CCE.htm" title="PromptForCredential Method " tocid="F8286CCE">PromptForCredential Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>UserAccountControl<span id="LSTA9E629C_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTA9E629C_0?cpp=::|nu=.");</script>GetProcessIntegrityLevel Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The function gets the integrity level of the current process. Integrity 
            level is only available on Windows Vista and newer operating systems, thus 
            GetProcessIntegrityLevel throws a C++ exception if it is called on systems 
            prior to Windows Vista.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="85360FD0.htm">TomsToolbox.Desktop</a><br />
    <strong>Assembly:</strong>
   TomsToolbox.Desktop (in TomsToolbox.Desktop.dll)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0ECCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','cs','1','2');return false;">C#</a></div><div id="ID0ECCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0ECCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0ECCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0ECCA');return false;" title="Copy">Copy</a></div></div><div id="ID0ECCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">int</span> <span class="identifier">GetProcessIntegrityLevel</span>()</pre></div><div id="ID0ECCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">GetProcessIntegrityLevel</span> <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0ECCA");</script><h4 class="subHeading">Return Value</h4>Type: <a href="https://docs.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">Int32</a><br />
            Returns the integrity level of the current process. It is usually one of 
            these values:
            
               SECURITY_MANDATORY_UNTRUSTED_RID - means untrusted level. It is used 
               by processes started by the Anonymous group. Blocks most write access.
               (SID: S-1-16-0x0)
               
               SECURITY_MANDATORY_LOW_RID - means low integrity level. It is used by
               Protected Mode Internet Explorer. Blocks write acess to most objects 
               (such as files and registry keys) on the system. (SID: S-1-16-0x1000)
            
               SECURITY_MANDATORY_MEDIUM_RID - means medium integrity level. It is 
               used by normal applications being launched while UAC is enabled. 
               (SID: S-1-16-0x2000)
               
               SECURITY_MANDATORY_HIGH_RID - means high integrity level. It is used 
               by administrative applications launched through elevation when UAC is 
               enabled, or normal applications if UAC is disabled and the user is an 
               administrator. (SID: S-1-16-0x3000)
               
               SECURITY_MANDATORY_SYSTEM_RID - means system integrity level. It is 
               used by services and other system-level applications (such as Wininit, 
               Winlogon, Smss, etc.)  (SID: S-1-16-0x4000)
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="tableSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="https://docs.microsoft.com/dotnet/api/system.componentmodel.win32exception" target="_blank" rel="noopener noreferrer">Win32Exception</a></td><td>
            When any native Windows API call fails, the function throws a Win32Exception 
            with the last error code.
            </td></tr></table></div></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="A126C345.htm">UserAccountControl Class</a></div><div class="seeAlsoStyle"><a href="85360FD0.htm">TomsToolbox.Desktop Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="https://github.com/tom-englert/TomsToolbox/blob/master/LICENSE" target="_blank" rel="noopener noreferrer">© tom-englert.de 2012-2023</a></p> </div></body></html>
